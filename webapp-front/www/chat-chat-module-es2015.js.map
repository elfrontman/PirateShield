{"version":3,"sources":["./src/app/chat/chat.page.html","./src/app/chat/chat.module.ts","./src/app/chat/chat.page.scss","./src/app/chat/chat.page.ts"],"names":[],"mappings":"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","file":"chat-chat-module-es2015.js","sourcesContent":["module.exports = \"<ion-header>\\n\\t<ion-toolbar color=\\\"primary\\\">\\n\\t\\t<ion-grid>\\n\\t\\t\\t<ion-row align-items-center>\\n\\t\\t\\t\\t<ion-col size=\\\"2\\\">\\n\\t\\t\\t\\t\\t<ion-buttons routerLink=\\\"/brands\\\">\\n\\t\\t\\t\\t\\t\\t<ion-button>\\n\\t\\t\\t\\t\\t\\t\\t<img class=\\\"icon-svg\\\" src=\\\"./assets/images/back.svg\\\">\\n\\t\\t\\t\\t\\t\\t</ion-button>\\n\\t\\t\\t\\t\\t</ion-buttons>\\n\\t\\t\\t\\t</ion-col>\\n\\t\\t\\t\\t<ion-col size=\\\"8\\\">\\n\\t\\t\\t\\t\\t<ion-title>CHAT</ion-title>\\t\\t\\t\\n\\t\\t\\t\\t</ion-col>\\n\\t\\t\\t\\t<ion-col size=\\\"2\\\">\\n\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t</ion-col>\\n\\t\\t\\t</ion-row>\\n\\t\\t</ion-grid>\\n\\t</ion-toolbar>\\n</ion-header>\\n\\n<ion-content #chatview>\\n\\t\\n\\t<ion-grid>\\n    \\n    <ion-row *ngFor=\\\"let message of messages\\\">\\n \\n      <ion-col size=\\\"9\\\"  [ngClass]=\\\"message.isAdmin ? 'other-message' : 'my-message'\\\" class=\\\"message\\\" [attr.offset] = \\\"message.isAdmin ? '' : 3\\\">\\n      \\t\\n      \\t<div [ngSwitch]=\\\"message.type\\\">\\n      \\t\\t<span *ngSwitchCase=\\\"'String'\\\">{{ message.message }}</span>\\t\\n      \\t\\t<img *ngSwitchCase=\\\"'Image'\\\" [src]=\\\"message.message\\\"/>\\n      \\t</div>\\n        \\n        <div class=\\\"time\\\" text-right>{{ message.createdAt | date:'short' }}</div>\\n      </ion-col>\\n \\n    </ion-row>\\n  </ion-grid>\\n\\t\\n</ion-content>\\n\\n<ion-footer>\\n  <ion-toolbar color=\\\"light\\\">\\n    <ion-row align-items-center>\\n      <ion-col size=\\\"8\\\">\\n        <ion-textarea auto-grow class=\\\"message-input\\\" rows=\\\"1\\\" [(ngModel)]=\\\"message\\\"></ion-textarea>\\n      </ion-col>\\n      <ion-col size=\\\"2\\\">\\n        <ion-button expand=\\\"block\\\" fill=\\\"clear\\\" color=\\\"primary\\\" class=\\\"msg-btn\\\"\\n          (click)=\\\"filechooser.click()\\\">\\n          <ion-icon name=\\\"ios-camera\\\" slot=\\\"icon-only\\\"></ion-icon>\\n          <input type=\\\"file\\\" #filechooser capture=\\\"camera\\\" hidden (change)=\\\"sendImageMessage(filechooser)\\\"/>\\n        </ion-button>\\n      </ion-col>\\n      <ion-col size=\\\"2\\\">\\n        <ion-button expand=\\\"block\\\" fill=\\\"clear\\\" color=\\\"primary\\\" [disabled]=\\\"message === ''\\\" class=\\\"msg-btn\\\"\\n          (click)=\\\"sendMessage()\\\">\\n          <ion-icon name=\\\"ios-send\\\" slot=\\\"icon-only\\\"></ion-icon>\\n        </ion-button>\\n      </ion-col>\\n    </ion-row>\\n  </ion-toolbar>\\n</ion-footer>\\n\"","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { ChatPage } from './chat.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: ChatPage\n  }\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [ChatPage]\n})\nexport class ChatPageModule {}\n","module.exports = \".message {\\n  padding: 10px;\\n  border-radius: 10px;\\n  margin-bottom: 4px;\\n  white-space: pre-wrap;\\n}\\n\\n.my-message {\\n  background: #3880ff;\\n  color: #fff;\\n}\\n\\n.other-message {\\n  background: #e3e3e3;\\n  color: #333;\\n}\\n\\n.time {\\n  color: #dfdfdf;\\n  float: right;\\n  font-size: small;\\n}\\n\\n.other-message .time {\\n  color: #333;\\n}\\n\\n.message-input {\\n  margin-top: 0px;\\n  background: #fff;\\n  min-height: 40px;\\n}\\n\\n.msg-btn {\\n  --padding-start: 0.5em;\\n  --padding-end: 0.5em;\\n}\\n\\n.icon-svg {\\n  width: 30px;\\n  height: 30px;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi92YXIvd3d3L2RqYW5nby9BZ2F0aGFEZW1vL1BpcmF0ZVNoaWVsZC93ZWJhcHAtZnJvbnQvc3JjL2FwcC9jaGF0L2NoYXQucGFnZS5zY3NzIiwic3JjL2FwcC9jaGF0L2NoYXQucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsYUFBQTtFQUNBLG1CQUFBO0VBQ0Esa0JBQUE7RUFDQSxxQkFBQTtBQ0NGOztBREVBO0VBQ0UsbUJBQUE7RUFDQSxXQUFBO0FDQ0Y7O0FERUE7RUFDRSxtQkFBQTtFQUNBLFdBQUE7QUNDRjs7QURFQTtFQUNFLGNBQUE7RUFDQSxZQUFBO0VBQ0EsZ0JBQUE7QUNDRjs7QURFQTtFQUNFLFdBQUE7QUNDRjs7QURFQTtFQUNFLGVBQUE7RUFDQSxnQkFBQTtFQUNBLGdCQUFBO0FDQ0Y7O0FERUE7RUFDRSxzQkFBQTtFQUNBLG9CQUFBO0FDQ0Y7O0FERUE7RUFDRSxXQUFBO0VBQ0EsWUFBQTtBQ0NGIiwiZmlsZSI6InNyYy9hcHAvY2hhdC9jaGF0LnBhZ2Uuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIi5tZXNzYWdlIHtcbiAgcGFkZGluZzogMTBweDtcbiAgYm9yZGVyLXJhZGl1czogMTBweDtcbiAgbWFyZ2luLWJvdHRvbTogNHB4O1xuICB3aGl0ZS1zcGFjZTogcHJlLXdyYXA7XG59XG5cbi5teS1tZXNzYWdlIHtcbiAgYmFja2dyb3VuZDogIzM4ODBmZjtcbiAgY29sb3I6ICNmZmY7XG59XG5cbi5vdGhlci1tZXNzYWdlIHtcbiAgYmFja2dyb3VuZDogI2UzZTNlMztcbiAgY29sb3I6ICMzMzM7XG59XG5cbi50aW1lIHtcbiAgY29sb3I6ICNkZmRmZGY7XG4gIGZsb2F0OiByaWdodDtcbiAgZm9udC1zaXplOiBzbWFsbDtcbn1cblxuLm90aGVyLW1lc3NhZ2UgLnRpbWV7XG4gIGNvbG9yOiAjMzMzO1xufVxuXG4ubWVzc2FnZS1pbnB1dCB7XG4gIG1hcmdpbi10b3A6IDBweDtcbiAgYmFja2dyb3VuZDogI2ZmZjtcbiAgbWluLWhlaWdodDogNDBweDtcbn1cblxuLm1zZy1idG4ge1xuICAtLXBhZGRpbmctc3RhcnQ6IDAuNWVtO1xuICAtLXBhZGRpbmctZW5kOiAwLjVlbTtcbn1cblxuLmljb24tc3Zne1xuICB3aWR0aDogMzBweDtcbiAgaGVpZ2h0OiAzMHB4O1xufVxuIiwiLm1lc3NhZ2Uge1xuICBwYWRkaW5nOiAxMHB4O1xuICBib3JkZXItcmFkaXVzOiAxMHB4O1xuICBtYXJnaW4tYm90dG9tOiA0cHg7XG4gIHdoaXRlLXNwYWNlOiBwcmUtd3JhcDtcbn1cblxuLm15LW1lc3NhZ2Uge1xuICBiYWNrZ3JvdW5kOiAjMzg4MGZmO1xuICBjb2xvcjogI2ZmZjtcbn1cblxuLm90aGVyLW1lc3NhZ2Uge1xuICBiYWNrZ3JvdW5kOiAjZTNlM2UzO1xuICBjb2xvcjogIzMzMztcbn1cblxuLnRpbWUge1xuICBjb2xvcjogI2RmZGZkZjtcbiAgZmxvYXQ6IHJpZ2h0O1xuICBmb250LXNpemU6IHNtYWxsO1xufVxuXG4ub3RoZXItbWVzc2FnZSAudGltZSB7XG4gIGNvbG9yOiAjMzMzO1xufVxuXG4ubWVzc2FnZS1pbnB1dCB7XG4gIG1hcmdpbi10b3A6IDBweDtcbiAgYmFja2dyb3VuZDogI2ZmZjtcbiAgbWluLWhlaWdodDogNDBweDtcbn1cblxuLm1zZy1idG4ge1xuICAtLXBhZGRpbmctc3RhcnQ6IDAuNWVtO1xuICAtLXBhZGRpbmctZW5kOiAwLjVlbTtcbn1cblxuLmljb24tc3ZnIHtcbiAgd2lkdGg6IDMwcHg7XG4gIGhlaWdodDogMzBweDtcbn0iXX0= */\"","import { Component, OnInit, AfterViewChecked, ViewChild, ElementRef } from '@angular/core';\nimport { Socket } from 'ngx-socket-io';\nimport { MainServicesService } from '../main-services.service';\n\n@Component({\n\tselector: 'app-chat',\n\ttemplateUrl: './chat.page.html',\n\tstyleUrls: ['./chat.page.scss'],\n})\nexport class ChatPage implements OnInit, AfterViewChecked {\n\n\t@ViewChild('chatview', {static: false}) private chatview: any;\n\n\n\tmessage = '';\n\tmessages:any = [];\n\ttokenUser = '';\n\n\tconstructor(private socket: Socket, private service: MainServicesService) { }\n\n\tngAfterViewChecked(){\n\t\t//this.scrollBottom();\n\t}\n\n\tngOnInit() {\n\t\tthis.socket.connect();\n\n\t\tthis.socket.fromEvent('chat-token').subscribe( (token:any) => {\n\t\t\t\n\t\t\tthis.service.setTokentChat(token.token)\n\t\t\t\t.subscribe( (data:any) => {\n\t\t\t\t\tif(data.created){\n\t\t\t\t\t\tlocalStorage.setItem('token_chat', token.token);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(data.token)\n\t\t\t\t\t\t\tlocalStorage.setItem('token_chat', data.token);\t\n\t\t\t\t\t}\n\n\n\n\t\t\t\t\tthis.tokenUser = localStorage.getItem('token_chat')\n\t\t\t\t\tthis.socket.emit('create', this.tokenUser)\n\n\t\t\t\t\tthis.service.getChat(this.tokenUser)\n\t\t\t\t\t\t.subscribe( data => {\n\t\t\t\t\t\t\tconsole.log(data)\n\t\t\t\t\t\t\tthis.messages = data;\n\t\t\t\t\t\t\tthis.scrollBottom();\n\t\t\t\t\t\t})\n\n\t\t\t\t})\n\t\t})\n\n\t\tthis.socket.fromEvent('received').subscribe( message => {\n\t\t\tthis.messages.push(message)\n\t\t\tthis.scrollBottom();\n\t\t})\n\n\t}\n\n\tsendMessage(){\n\t\tlet msg = {message: this.message, token: this.tokenUser, type: 'String'}\n\t\tthis.socket.emit('send-message', msg)\n\t\tthis.messages.push(msg)\n\t\tthis.message = '';\n\t\tthis.scrollBottom();\n\t}\n\n\tsendImageMessage(file_input){\n\n\t\tlet reader = new FileReader();\n\n\t\treader.onload = (evt:any) =>{\n\t\t\tvar msg = {\n\t\t\t\ttoken: this.tokenUser,\n\t\t\t\tmessage: evt.target.result,\n\t\t\t\ttype: 'Image'\n\t\t\t}\n\t\t\tconsole.log(msg)\n\t\t\tthis.socket.emit('send-file', msg)\n\t\t\tthis.messages.push(msg)\n\t\t}\n\t\tconsole.log(file_input.files[0])\n\t\treader.readAsDataURL(file_input.files[0]);\n\t\tthis.scrollBottom();\n\t}\n\n\tionViewWillLeave(){\n\t\tthis.socket.disconnect();\n\t}\n\n\tscrollBottom(){\n\t\ttry{\n\t\t\tsetTimeout( _ => {\n\t\t\t\tthis.chatview.el.scrollToBottom(0)\t\t\t\t\n\t\t\t})\n\t\t\t\n\t\t}catch(err){ console.log(err) }\n\t}\n\n}\n"],"sourceRoot":""}