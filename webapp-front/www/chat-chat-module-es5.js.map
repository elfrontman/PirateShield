{"version":3,"sources":["./src/app/chat/chat.page.html","./src/app/chat/chat.module.ts","./src/app/chat/chat.page.scss","./src/app/chat/chat.page.ts"],"names":[],"mappings":"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","file":"chat-chat-module-es5.js","sourcesContent":["module.exports = \"<ion-header>\\n\\t<ion-toolbar color=\\\"primary\\\">\\n\\t\\t<ion-grid>\\n\\t\\t\\t<ion-row align-items-center>\\n\\t\\t\\t\\t<ion-col size=\\\"2\\\">\\n\\t\\t\\t\\t\\t<ion-buttons routerLink=\\\"/brands\\\">\\n\\t\\t\\t\\t\\t\\t<ion-button>\\n\\t\\t\\t\\t\\t\\t\\t<img class=\\\"icon-svg\\\" src=\\\"./assets/images/back.svg\\\">\\n\\t\\t\\t\\t\\t\\t</ion-button>\\n\\t\\t\\t\\t\\t</ion-buttons>\\n\\t\\t\\t\\t</ion-col>\\n\\t\\t\\t\\t<ion-col size=\\\"8\\\">\\n\\t\\t\\t\\t\\t<ion-title>CHAT</ion-title>\\t\\t\\t\\n\\t\\t\\t\\t</ion-col>\\n\\t\\t\\t\\t<ion-col size=\\\"2\\\">\\n\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t</ion-col>\\n\\t\\t\\t</ion-row>\\n\\t\\t</ion-grid>\\n\\t</ion-toolbar>\\n</ion-header>\\n\\n<ion-content #chatview>\\n\\t\\n\\t<ion-grid>\\n    \\n    <ion-row *ngFor=\\\"let message of messages\\\">\\n \\n      <ion-col size=\\\"9\\\"  [ngClass]=\\\"message.isAdmin ? 'other-message' : 'my-message'\\\" class=\\\"message\\\" [attr.offset] = \\\"message.isAdmin ? '' : 3\\\">\\n      \\t\\n      \\t<div [ngSwitch]=\\\"message.type\\\">\\n      \\t\\t<span *ngSwitchCase=\\\"'String'\\\">{{ message.message }}</span>\\t\\n      \\t\\t<img *ngSwitchCase=\\\"'Image'\\\" [src]=\\\"message.message\\\"/>\\n      \\t</div>\\n        \\n        <div class=\\\"time\\\" text-right>{{ message.createdAt | date:'short' }}</div>\\n      </ion-col>\\n \\n    </ion-row>\\n  </ion-grid>\\n\\t\\n</ion-content>\\n\\n<ion-footer>\\n  <ion-toolbar color=\\\"light\\\">\\n    <ion-row align-items-center>\\n      <ion-col size=\\\"8\\\">\\n        <ion-textarea auto-grow class=\\\"message-input\\\" rows=\\\"1\\\" [(ngModel)]=\\\"message\\\"></ion-textarea>\\n      </ion-col>\\n      <ion-col size=\\\"2\\\">\\n        <ion-button expand=\\\"block\\\" fill=\\\"clear\\\" color=\\\"primary\\\" class=\\\"msg-btn\\\"\\n          (click)=\\\"filechooser.click()\\\">\\n          <ion-icon name=\\\"ios-camera\\\" slot=\\\"icon-only\\\"></ion-icon>\\n          <input type=\\\"file\\\" #filechooser capture=\\\"camera\\\" hidden (change)=\\\"sendImageMessage(filechooser)\\\"/>\\n        </ion-button>\\n      </ion-col>\\n      <ion-col size=\\\"2\\\">\\n        <ion-button expand=\\\"block\\\" fill=\\\"clear\\\" color=\\\"primary\\\" [disabled]=\\\"message === ''\\\" class=\\\"msg-btn\\\"\\n          (click)=\\\"sendMessage()\\\">\\n          <ion-icon name=\\\"ios-send\\\" slot=\\\"icon-only\\\"></ion-icon>\\n        </ion-button>\\n      </ion-col>\\n    </ion-row>\\n  </ion-toolbar>\\n</ion-footer>\\n\"","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { ChatPage } from './chat.page';\nimport { environment } from './../../environments/environment';\n\nimport { SocketIoModule, SocketIoConfig } from 'ngx-socket-io';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: ChatPage\n  }\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    RouterModule.forChild(routes),\n    SocketIoModule.forRoot(environment.SoketIoConfig)\n  ],\n  declarations: [ChatPage]\n})\nexport class ChatPageModule {}\n","module.exports = \".message {\\n  padding: 10px;\\n  border-radius: 10px;\\n  margin-bottom: 4px;\\n  white-space: pre-wrap;\\n}\\n\\n.my-message {\\n  background: #3880ff;\\n  color: #fff;\\n}\\n\\n.other-message {\\n  background: #e3e3e3;\\n  color: #333;\\n}\\n\\n.time {\\n  color: #dfdfdf;\\n  float: right;\\n  font-size: small;\\n}\\n\\n.other-message .time {\\n  color: #333;\\n}\\n\\n.message-input {\\n  margin-top: 0px;\\n  background: #fff;\\n  min-height: 40px;\\n}\\n\\n.msg-btn {\\n  --padding-start: 0.5em;\\n  --padding-end: 0.5em;\\n}\\n\\n.icon-svg {\\n  width: 30px;\\n  height: 30px;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9BcHBsaWNhdGlvbnMvTUFNUC9odGRvY3MvUGlyYXRlU2hpZWxkL3dlYmFwcC1mcm9udC9zcmMvYXBwL2NoYXQvY2hhdC5wYWdlLnNjc3MiLCJzcmMvYXBwL2NoYXQvY2hhdC5wYWdlLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxhQUFBO0VBQ0EsbUJBQUE7RUFDQSxrQkFBQTtFQUNBLHFCQUFBO0FDQ0Y7O0FERUE7RUFDRSxtQkFBQTtFQUNBLFdBQUE7QUNDRjs7QURFQTtFQUNFLG1CQUFBO0VBQ0EsV0FBQTtBQ0NGOztBREVBO0VBQ0UsY0FBQTtFQUNBLFlBQUE7RUFDQSxnQkFBQTtBQ0NGOztBREVBO0VBQ0UsV0FBQTtBQ0NGOztBREVBO0VBQ0UsZUFBQTtFQUNBLGdCQUFBO0VBQ0EsZ0JBQUE7QUNDRjs7QURFQTtFQUNFLHNCQUFBO0VBQ0Esb0JBQUE7QUNDRjs7QURFQTtFQUNFLFdBQUE7RUFDQSxZQUFBO0FDQ0YiLCJmaWxlIjoic3JjL2FwcC9jaGF0L2NoYXQucGFnZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLm1lc3NhZ2Uge1xuICBwYWRkaW5nOiAxMHB4O1xuICBib3JkZXItcmFkaXVzOiAxMHB4O1xuICBtYXJnaW4tYm90dG9tOiA0cHg7XG4gIHdoaXRlLXNwYWNlOiBwcmUtd3JhcDtcbn1cblxuLm15LW1lc3NhZ2Uge1xuICBiYWNrZ3JvdW5kOiAjMzg4MGZmO1xuICBjb2xvcjogI2ZmZjtcbn1cblxuLm90aGVyLW1lc3NhZ2Uge1xuICBiYWNrZ3JvdW5kOiAjZTNlM2UzO1xuICBjb2xvcjogIzMzMztcbn1cblxuLnRpbWUge1xuICBjb2xvcjogI2RmZGZkZjtcbiAgZmxvYXQ6IHJpZ2h0O1xuICBmb250LXNpemU6IHNtYWxsO1xufVxuXG4ub3RoZXItbWVzc2FnZSAudGltZXtcbiAgY29sb3I6ICMzMzM7XG59XG5cbi5tZXNzYWdlLWlucHV0IHtcbiAgbWFyZ2luLXRvcDogMHB4O1xuICBiYWNrZ3JvdW5kOiAjZmZmO1xuICBtaW4taGVpZ2h0OiA0MHB4O1xufVxuXG4ubXNnLWJ0biB7XG4gIC0tcGFkZGluZy1zdGFydDogMC41ZW07XG4gIC0tcGFkZGluZy1lbmQ6IDAuNWVtO1xufVxuXG4uaWNvbi1zdmd7XG4gIHdpZHRoOiAzMHB4O1xuICBoZWlnaHQ6IDMwcHg7XG59XG4iLCIubWVzc2FnZSB7XG4gIHBhZGRpbmc6IDEwcHg7XG4gIGJvcmRlci1yYWRpdXM6IDEwcHg7XG4gIG1hcmdpbi1ib3R0b206IDRweDtcbiAgd2hpdGUtc3BhY2U6IHByZS13cmFwO1xufVxuXG4ubXktbWVzc2FnZSB7XG4gIGJhY2tncm91bmQ6ICMzODgwZmY7XG4gIGNvbG9yOiAjZmZmO1xufVxuXG4ub3RoZXItbWVzc2FnZSB7XG4gIGJhY2tncm91bmQ6ICNlM2UzZTM7XG4gIGNvbG9yOiAjMzMzO1xufVxuXG4udGltZSB7XG4gIGNvbG9yOiAjZGZkZmRmO1xuICBmbG9hdDogcmlnaHQ7XG4gIGZvbnQtc2l6ZTogc21hbGw7XG59XG5cbi5vdGhlci1tZXNzYWdlIC50aW1lIHtcbiAgY29sb3I6ICMzMzM7XG59XG5cbi5tZXNzYWdlLWlucHV0IHtcbiAgbWFyZ2luLXRvcDogMHB4O1xuICBiYWNrZ3JvdW5kOiAjZmZmO1xuICBtaW4taGVpZ2h0OiA0MHB4O1xufVxuXG4ubXNnLWJ0biB7XG4gIC0tcGFkZGluZy1zdGFydDogMC41ZW07XG4gIC0tcGFkZGluZy1lbmQ6IDAuNWVtO1xufVxuXG4uaWNvbi1zdmcge1xuICB3aWR0aDogMzBweDtcbiAgaGVpZ2h0OiAzMHB4O1xufSJdfQ== */\"","import { Component, OnInit, AfterViewChecked, ViewChild, ElementRef } from '@angular/core';\nimport { Socket } from 'ngx-socket-io';\nimport { MainServicesService } from '../main-services.service';\n\n@Component({\n\tselector: 'app-chat',\n\ttemplateUrl: './chat.page.html',\n\tstyleUrls: ['./chat.page.scss'],\n})\nexport class ChatPage implements OnInit, AfterViewChecked {\n\n\t@ViewChild('chatview', {static: false}) private chatview: any;\n\n\n\tmessage = '';\n\tmessages:any = [];\n\ttokenUser = '';\n\n\tconstructor(private socket: Socket, private service: MainServicesService) { }\n\n\tngAfterViewChecked(){\n\t\t//this.scrollBottom();\n\t}\n\n\tngOnInit() {\n\t\tthis.socket.connect();\n\n\t\tconsole.log('init', this.socket)\n\n\t\tthis.socket.fromEvent('chat-token').subscribe( (token:any) => {\n\n\t\t\tconsole.log(token)\n\t\t\t\n\t\t\tthis.service.setTokentChat(token.token)\n\t\t\t\t.subscribe( (data:any) => {\n\t\t\t\t\tif(data.created){\n\t\t\t\t\t\tlocalStorage.setItem('token_chat', token.token);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(data.token)\n\t\t\t\t\t\t\tlocalStorage.setItem('token_chat', data.token);\t\n\t\t\t\t\t}\n\n\n\n\t\t\t\t\tthis.tokenUser = localStorage.getItem('token_chat')\n\t\t\t\t\tthis.socket.emit('create', this.tokenUser)\n\n\t\t\t\t\tthis.service.getChat(this.tokenUser)\n\t\t\t\t\t\t.subscribe( data => {\n\t\t\t\t\t\t\tconsole.log(data)\n\t\t\t\t\t\t\tthis.messages = data;\n\t\t\t\t\t\t\tthis.scrollBottom();\n\t\t\t\t\t\t})\n\n\t\t\t\t})\n\t\t})\n\n\t\tthis.socket.fromEvent('received').subscribe( message => {\n\t\t\tthis.messages.push(message)\n\t\t\tthis.scrollBottom();\n\t\t})\n\n\t}\n\n\tsendMessage(){\n\t\tlet msg = {message: this.message, token: this.tokenUser, type: 'String'}\n\t\tthis.socket.emit('send-message', msg)\n\t\tthis.messages.push(msg)\n\t\tthis.message = '';\n\t\tthis.scrollBottom();\n\t}\n\n\tsendImageMessage(file_input){\n\n\t\tlet reader = new FileReader();\n\n\t\treader.onload = (evt:any) =>{\n\t\t\tvar msg = {\n\t\t\t\ttoken: this.tokenUser,\n\t\t\t\tmessage: evt.target.result,\n\t\t\t\ttype: 'Image'\n\t\t\t}\n\t\t\tconsole.log(msg)\n\t\t\tthis.socket.emit('send-file', msg)\n\t\t\tthis.messages.push(msg)\n\t\t}\n\t\tconsole.log(file_input.files[0])\n\t\treader.readAsDataURL(file_input.files[0]);\n\t\tthis.scrollBottom();\n\t}\n\n\tionViewWillLeave(){\n\t\tthis.socket.disconnect();\n\t}\n\n\tscrollBottom(){\n\t\ttry{\n\t\t\tsetTimeout( _ => {\n\t\t\t\tthis.chatview.el.scrollToBottom(0)\t\t\t\t\n\t\t\t})\n\t\t\t\n\t\t}catch(err){ console.log(err) }\n\t}\n\n}\n"],"sourceRoot":""}